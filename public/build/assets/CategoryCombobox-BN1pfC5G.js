import{a as E,i as N,j as r,q as n,C,v as T,K as d,M as D,r as c,s as m,A as k,k as L,l as x,F as S,I as R,y as P,G as b,E as F,T as M,x as i}from"./vendor-COAloQYc.js";import{ae as U,P as j,r as A}from"./ui-D5A2uRRy.js";const q=["placeholder"],G={key:0,class:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none"},I={class:"text-slate-900 font-semibold text-sm"},K={class:"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none"},O=["onClick"],Q={class:"flex items-center gap-3"},H={key:1,class:"px-4 py-2 text-gray-500 text-sm"},Y={__name:"CategoryCombobox",props:{modelValue:[String,Number],categories:{type:Array,default:()=>[]},type:String,placeholder:String,itemValue:{type:String,default:"name"},itemLabel:{type:String,default:"name"},canCreate:{type:Boolean,default:!0}},emits:["update:modelValue","limitReached"],setup(l,{emit:$}){const s=l,v=$,u=c(!1),o=c(""),z=c(null),p=c(null),y=c({top:"0px",left:"0px",width:"0px"}),g=k(()=>{const e=s.categories.filter(t=>t.type===s.type);return o.value?e.filter(t=>t[s.itemLabel].toLowerCase().includes(o.value.toLowerCase())):e}),B=k(()=>{if(!s.modelValue)return"";const e=s.categories.find(t=>t[s.itemValue]===s.modelValue);return e?e[s.itemLabel]:s.modelValue}),w=()=>{if(p.value){const e=p.value.getBoundingClientRect();y.value={top:`${e.bottom+8}px`,left:`${e.left}px`,width:`${e.width}px`}}},h=()=>{w(),u.value=!0},f=()=>{u.value&&w()};E(()=>{window.addEventListener("resize",f),window.addEventListener("scroll",f,!0)}),N(()=>{window.removeEventListener("resize",f),window.removeEventListener("scroll",f,!0)});const V=e=>{if(typeof e=="string"){if(!s.canCreate){v("limitReached"),u.value=!1,o.value="";return}v("update:modelValue",e)}else v("update:modelValue",e[s.itemValue]);u.value=!1,o.value=""};return(e,t)=>(i(),r("div",{ref_key:"triggerRef",ref:p,class:"relative"},[n("div",{class:"w-full relative cursor-pointer",onClick:h},[T(n("input",{ref_key:"inputRef",ref:z,type:"text","onUpdate:modelValue":t[0]||(t[0]=a=>o.value=a),class:"w-full bg-slate-50 border border-slate-200 text-slate-900 placeholder-slate-400 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none transition-all font-semibold text-sm px-4 py-3 pr-10 cursor-pointer",placeholder:u.value&&!l.modelValue?e.__("search_placeholder"):l.modelValue?"":l.placeholder||e.__("select_or_type_category"),onFocus:h},null,40,q),[[D,o.value]]),l.modelValue&&!o.value?(i(),r("div",G,[n("span",I,m(B.value),1)])):d("",!0),l.modelValue&&!o.value?(i(),r("div",{key:1,class:"absolute inset-0 bg-transparent",onClick:t[1]||(t[1]=a=>{o.value=""})})):d("",!0),n("span",K,[L(x(U),{class:"w-5 h-5 text-gray-400"})])]),(i(),C(M,{to:"body"},[u.value?(i(),r(S,{key:0},[n("div",{onClick:t[2]||(t[2]=a=>u.value=!1),class:"fixed inset-0 z-[9998] bg-transparent cursor-default"}),n("div",{class:"fixed z-[9999] max-h-60 overflow-auto bg-white border border-slate-200 rounded-2xl shadow-2xl py-2 animate-in fade-in slide-in-from-top-2 duration-200 ring-1 ring-slate-900/5 origin-top",style:F(y.value)},[o.value&&!g.value.find(a=>a[l.itemLabel].toLowerCase()===o.value.toLowerCase())?(i(),r("div",{key:0,onClick:t[3]||(t[3]=a=>V(o.value)),class:"px-5 py-3 hover:bg-indigo-50 text-indigo-600 cursor-pointer flex items-center gap-2 border-b border-slate-100 font-semibold text-sm"},[L(x(j),{class:"w-4 h-4"}),n("span",null,[R(m(e.__("create_new"))+' "',1),n("strong",null,m(o.value),1),t[4]||(t[4]=R('"',-1))])])):d("",!0),(i(!0),r(S,null,P(g.value,a=>(i(),r("div",{key:a.id,onClick:J=>V(a),class:b(["px-5 py-3 hover:bg-slate-50 cursor-pointer flex items-center justify-between group transition-colors",{"bg-indigo-50":l.modelValue===a[l.itemValue]}])},[n("div",Q,[n("div",{class:b([a.color,"w-2.5 h-2.5 rounded-full shadow-sm"])},null,2),n("span",{class:b(["text-sm",l.modelValue===a[l.itemValue]?"text-indigo-700 font-semibold":"text-slate-900 font-medium"])},m(a[l.itemLabel]),3)]),l.modelValue===a[l.itemValue]?(i(),C(x(A),{key:0,class:"w-4 h-4 text-indigo-700"})):d("",!0)],10,O))),128)),g.value.length===0&&!o.value?(i(),r("div",H,m(e.__("no_categories_found")),1)):d("",!0)],4)],64)):d("",!0)]))],512))}};export{Y as _};
